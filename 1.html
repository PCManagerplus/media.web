<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>入力場所</title>
<!-- Material Design ライブラリの読み込み -->
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
<!-- jQuery ライブラリの読み込み -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<!-- Materialize ライブラリの読み込み -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
</head>
<body>

<div class="container">
  <h4>入力場所</h4>
  <div class="row">
    <form class="col s12" action="https://pcmanagerplus.github.io/media.web/" method="get">
      <div class="row">
        <div class="input-field col s12">
          <input id="inputField" type="text" class="validate" name="inputField" onkeyup="showAccessButton()">
          <label for="inputField">入力場所</label>
        </div>
      </div>
      <div class="row">
        <button id="accessButton" class="btn waves-effect waves-light" type="submit" style="display:none;">アクセス
          <i class="material-icons right">send</i>
        </button>
      </div>
    </form>
  </div>
</div>

<!-- アクセスキーダイアログ -->
<div id="accessDialog" class="modal">
  <div class="modal-content">
    <h4>アクセスキーを入力してください</h4>
    <input id="accessKeyInput" type="password" class="validate">
  </div>
  <div class="modal-footer">
    <a href="#!" class="modal-close waves-effect waves-green btn-flat" onclick="checkAccessKey()">OK</a>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  var elems = document.querySelectorAll('.modal');
  var instances = M.Modal.init(elems, {dismissible: false});
});

function showAccessButton() {
  var inputField = document.getElementById("inputField");
  var accessButton = document.getElementById("accessButton");
  if (inputField.value.trim() !== "") {
    accessButton.style.display = "block";
  } else {
    accessButton.style.display = "none";
  }
}

function checkAccessKey() {
  var accessKeyInput = document.getElementById("accessKeyInput").value;
  var encryptedAccessKey = encryptAccessKey(accessKeyInput);
  var correctEncryptedKey = "eccbc87e4b5ce2fe28308fd9f2a7baf3"; 
  
  if (encryptedAccessKey === correctEncryptedKey) {
    var accessDialog = document.getElementById("accessDialog");
    var instance = M.Modal.getInstance(accessDialog);
    instance.close();
  } else {
    alert("アクセスキーが正しくありません。もう一度お試しください。");
  }
}

function encryptAccessKey(accessKey) {
  // アクセスキーの暗号化方法を定義
  // ここでは単純にMD5ハッシュを使っていますが、実際にはより安全な暗号化方式を使用することをお勧めします。
  return md5(accessKey);
}
</script>

</body>
</html>
